Workflow indicators
===================


There is an viewlet manager which renders workflow indicators for content
objects (note that the ``view`` argument is not really relevant)[#setup]_:

>>> import zope.component
>>> import zope.viewlet.interfaces
>>> a_view = zope.component.getMultiAdapter(
...     (repository, request), name='view.html')
>>> viewlet_manager = zope.component.getMultiAdapter(
...     (content, request, a_view),
...     zope.viewlet.interfaces.IViewletManager,
...     name='zeit.cms.workflow-indicator')
>>> viewlet_manager.update()
>>> print viewlet_manager.render()
<img class="publish-state" src="http://127.0.0.1/@@/zeit.cms/icons/not-published.png" title="Not published" />

# XXX move workflow tests from listing.txt to here.


>>> zope.security.management.endInteraction()
>>> zope.app.component.hooks.setSite(old_site)


.. [#setup]

    >>> import zope.app.component.hooks
    >>> old_site = zope.app.component.hooks.getSite()
    >>> zope.app.component.hooks.setSite(getRootFolder())

    >>> import zeit.cms.repository.interfaces
    >>> repository = zope.component.getUtility(
    ...     zeit.cms.repository.interfaces.IRepository)
    >>> content = repository['testcontent']

    >>> import zope.publisher.browser
    >>> import zope.security.testing
    >>> import zeit.cms.browser.interfaces
    >>> request = zope.publisher.browser.TestRequest(
    ...     skin=zeit.cms.browser.interfaces.ICMSSkin)
    >>> request.setPrincipal(
    ...     zope.security.testing.Principal(u'zope.globalmgr'))
    >>> import zope.security.management
    >>> zope.security.management.newInteraction(request)
