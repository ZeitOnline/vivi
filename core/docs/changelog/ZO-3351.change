ZO-3351: lock and unlock for every function that requires the lock